# Infrastructure Deployment Recommendations

## Executive Summary

This infrastructure plan was generated by Inframate based on analyzing your application's requirements and codebase structure.

### Recommended AWS Services:

**
EC2, VPC, Security Groups, Route 53, S3, CloudWatch, IAM, MongoDB Atlas (Optional), Elastic Load Balancing (ALB or NLB)

**

## Detailed Recommendations

**
*   **Infrastructure:**
    *   **VPC:** Create a Virtual Private Cloud (VPC) to isolate the application within a private network.
    *   **Subnets:** Define public and private subnets within the VPC for different tiers of the application.
    *   **Security Groups:** Implement security groups to control inbound and outbound traffic to EC2 instances.  At a minimum, allow SSH (port 22) only from your workstation IP for administrative access, and allow HTTP (port 80) and/or HTTPS (port 443) traffic from the ALB/NLB. For MongoDB, configure security groups to allow traffic on port 27017.  For managed MongoDB, you will configure the managed service IP address ranges in the security group associated with the instance.
    *   **EC2 Instances:** Use EC2 instances to host the application.  The file extensions suggest a React/TypeScript based frontend and a Node.js based backend.  Consider using Amazon Linux 2 or Ubuntu as the operating system.  Choose instance types (e.g., t3.medium) based on the application's resource requirements and expected traffic.
    *   **Load Balancing:** Employ Elastic Load Balancing (ALB or NLB) to distribute traffic across multiple EC2 instances, improving availability and scalability. ALB is preferable if the backend uses HTTP/HTTPS; NLB if you need TCP/UDP forwarding.
    *   **MongoDB:**  Since `has_kubernetes` is false, and a full deployment model is needed, consider either:
        *   **MongoDB Atlas:**  Use MongoDB Atlas, a managed MongoDB service, to simplify database management and ensure high availability. It will be the fastest path to launch.
        *   **EC2-based MongoDB:** If there are constraints on cost, use EC2 instances to host MongoDB. This requires manual setup, configuration, and maintenance, including replication, backups, and monitoring.  This option increases operational burden significantly.
    *   **S3 Bucket:** Create an S3 bucket to store static assets (images, CSS, JavaScript files). Configure CloudFront for optimized content delivery if necessary.
    *   **IAM Roles:** Implement IAM roles with the principle of least privilege to grant EC2 instances and other AWS resources the necessary permissions to access other AWS services.
    *   **CloudWatch Monitoring:** Use CloudWatch for monitoring EC2 instances, the load balancer, and MongoDB (if self-hosted), setting up alarms for key metrics like CPU utilization, memory usage, and disk space.
    *   **Route 53:** Use Route 53 to manage DNS records and route traffic to the load balancer.
    *   **Automated Deployments:** Due to `has_ci` being false, the Terraform setup assumes manual deploys after the infra has been set up. For actual prod deployments set up a CI/CD pipeline with something like Github Actions or AWS CodePipeline.
*   **Application-Specific:**
    *   **Node.js Setup:** Ensure the Node.js runtime is installed and configured on the EC2 instances.
    *   **Process Manager:** Use a process manager like PM2 or systemd to ensure the application restarts automatically if it crashes.
    *   **Environment Variables:** Configure environment variables (e.g., database connection string, API keys) securely, preferably using AWS Systems Manager Parameter Store or Secrets Manager, and fetch these within the app.
**

## Estimated Monthly Costs

**
This is a rough estimate and depends on the specific instance types, storage requirements, and traffic patterns.  I'll use sample configurations for demonstration purposes.
*   **EC2 (2 x t3.medium instances):**  $30 - $60/month (depending on region and operating system)
*   **Elastic Load Balancer (ALB):** $20 - $30/month (based on usage)
*   **MongoDB Atlas (M10 Cluster):** $60/month (minimal cost estimate - can be more depending on the usage) *OR* EC2 for MongoDB: Similar to application server, $30 - $60/month for a t3.medium instance
*   **S3 Storage:**  $1 - $5/month (depending on storage used)
*   **CloudWatch:** $5 - $10/month (based on logs ingested and metrics stored)
*   **VPC/Networking:**  Minimal cost, typically less than $5/month
*   **Route 53:** Minimal cost, typically less than $1/month
**Total Estimated Monthly Cost:**  $116 - $176 (with MongoDB Atlas) or $86 - $146 (with self-hosted MongoDB - but MUCH more operational overhead). This is just a starting estimate. This cost will need to be reviewed and refined based on the application's performance and resource needs over time.
**

*Note: These cost estimates are approximate and may vary based on usage patterns, region, and AWS pricing changes.*

## Deployment Instructions

1. **Prerequisites**:
   - AWS CLI configured with appropriate credentials
   - Terraform installed (v1.0.0+)

2. **Configuration**:
   - Update variables in `terraform.tfvars` to match your requirements
   - Review the Terraform files to ensure they meet your needs

3. **Deployment**:
   ```bash
   terraform init
   terraform plan
   terraform apply
   ```

4. **Cleanup**:
   ```bash
   terraform destroy
   ```

## Notes

- The Terraform files have been generated in the `terraform/` directory
- The configuration is based on the application requirements specified in `inframate.md`
- You may need to customize the Terraform files for your specific needs
